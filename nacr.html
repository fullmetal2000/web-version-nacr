<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css"/>
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script>
    <script src="js/getdata.js"></script>
    <script src="js/buildpages.js"></script>
    <link rel="stylesheet" href="css/news_record.css"/>
</head>
<body>

<script>
    //this is a tag
    (function () {

        URLInfo.baseurl = "http://cnewsfinder.appspot.com/?";
        URLInfo.keywords = 'sitename';
        URLInfo.value = 'wenxuecity';
        var url = URLInfo.baseurl + URLInfo.keywords + '=' + URLInfo.value;
        var result = {};
        $.getJSON(url, function (data) {

            result = data;

            var reclist = data['website'];
            var pageData='';
            $.each(reclist, function (id, data) {
                idx=id+1;
                var number = idx/5;

                //if (idx < 30) {

                pageData +=
                        "<div class="+'div_'+idx%5 +" class='content_div'>" +

                            "<img class='img' src=" + data["img"] + ">" +
                            "<div class='article'>"+

                                "<h3 class='title'>" + data["title"] + "</h3>" +
                               "<span class='timeauthor'>" + data["time"] + " " + data["author"] + "</span>" +
                                 data["article"] + "</div>" +

                        "</div>" ;



//                console.log('title:' + data["title"]);
//                console.log('time:' + data["time"]);
//                console.log('author:' + data["author"]);
//                console.log('img:' + data["img"]);
//                console.log('article:' + data["article"]);

                if ((idx % 5 == 0) && (idx!=0)){
                    console.log(idx);
                    var newPage = $(
                            "<div class='ui-page hidden' data-role='page'  id=" + "page_" + number + "> " +

                                "<div class="+"css_"+number%5+">"+
                                    "<div  class='header'>" +
                                    "<h3>Head</h3>" +
                                    "</div>" +

                                    pageData+  // this is the 5 news block

                                    "<div class='footer'>" +
                                    "<h3>Page Footer</h3>" +
                                    "</div>" +
                                "</div>"+

                            "</div>"

                    );

                    newPage.appendTo($.mobile.pageContainer);
                    //empty pageData
                    pageData='';
                }//,every 5 news create new page, empty pageData.

             //   }

            });

            //
            $('#page_0').removeClass("hidden");
            $.mobile.changePage('#page_1');


            //below code to modify the real size of image and article
            var winH = $(window).height();
            var winW = $(window).width();

            var basic_height_a = winH * 46 / 100,
                    basic_height_b = winH * 43 / 100,
                    basic_width = winW / 2;

//        $('.ui-grid-a').height(winH/3);
//        $('.ui-grid-b').height(winH/2);

            //
            $('.ui-grid-a').height(basic_height_a);
            $('.ui-grid-b').height(basic_height_b);

            $('div.ui-page').on("swipeleft", function () {
                console.log('swipe');
                var nextpage = $(this).next('div[data-role="page"]');

                if (nextpage.length > 0) {
                    $.mobile.changePage(nextpage, {transition:"slide",
                        reverse:false}, true, true);

                }
            });
            $('div.ui-page').on("swiperight", function () {
                console.log('swipe');
                var prevpage = $(this).prev('div[data-role="page"]');
                if (prevpage.length > 0) {
                    $.mobile.changePage(prevpage, {transition:"slide",
                        reverse:true}, true, true);

                }
            });


        });


    })();
</script>
</body>
</html>